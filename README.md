# tox.js

Tox RPC 框架 Node.js 实现

- 支持 HPACK, 默认开启
- 支持多种序列化协议, hessian/hessian2/protobuf/kiritobuf/json/TBinaryProtocol, 默认 hession2
- 支持 CRC32 校验, 默认关闭

## 报文消息格式
```
Request
0        1        2                 4                 6                 8                 10                12
+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+
|  proto |  type  |  codec | version| isCrc  | isHpack|   headerLength  |           timeout                 |
+--------+--------+--------+--------+--------+--------+--------+-----------------+-----------------+--------+
|                           requestId                                   |           bodyLength              |
+-----------------------------------------------------------------------+-----------------------------------+
|               header  + content                                                                           |
+                                                                       +-----------------+-----------------+
|                               ... ...                                 |             crc32                 |
+-----------------------------------------------------------------------------------------------------------+
```

```
Response
0        1        2                 4                 6                 8                 10                12
+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+
|  proto |  type  |  codec | version| isCrc  | isHpack|   headerLength  |              requestId            |
+--------+--------+--------+--------+--------+--------+--------+-----------------+-----------------+--------+
|              requestId            |               bodyLength          |              ... ...              |
+-----------------------------------------------------------------------+                                   +
|               header  + content                                                                           |
+                                                                       +-----------------+-----------------+
|                               ... ...                                 |             crc32                 |
+-----------------------------------------------------------------------------------------------------------+
```
- proto 标识是否是 TOX 协议
- type 标识数据包是请求还是响应
- codec 序列化协议类型
- version TOX 协议版本
- isCrc 是否开启 crc32 校验
- isHpack 是否开启 HPACK 头部压缩
- headerLength 头部长度
- timeout 请求超时时间
- requestId 请求数据包ID
- bodyLength 数据包 body 长度
- crc32 当 isCrc 为 0x01 时有该值，为消息体的 crc32 值

## 高级功能
- 通过 `Consul` 实现服务注册与服务发现

## Author
tox.jx © [Ricky 泽阳](https://github.com/rickyes), Released under the MIT License. 